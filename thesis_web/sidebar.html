<!-- ===== PERSISTENT SIDEBAR COMPONENT ===== -->
<style>
    /* Enhanced variables for consistent styling */
    :root {
        --primary-dark: #0b2a3a;
        --primary-medium: #1a4a60;
        --accent-color: #1ea7d7;
        --accent-hover: #4fc9f0;
        --text-light: #dffaff;
        --text-medium: #a8d4e5;
        --shadow-heavy: 0 10px 40px rgba(0, 0, 0, 0.5);
        --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.2);
        --transition-speed: 0.4s;
        --border-radius: 0 12px 12px 0;
    }
    
    /* Main sidebar container */
    .sidebar {
        position: fixed;
        top: 0;
        left: -300px;
        width: 280px;
        height: 100%;
        background: linear-gradient(180deg, var(--primary-dark) 0%, #0d3142 100%);
        display: flex;
        flex-direction: column;
        padding: 120px 0 40px 0;
        transition: var(--transition-speed) cubic-bezier(0.25, 0.46, 0.45, 0.94);
        z-index: 1002;
        box-shadow: var(--shadow-heavy);
        border-radius: var(--border-radius);
        overflow: hidden;
    }
    
    /* Decorative background element */
    .sidebar::before {
        content: '';
        position: absolute;
        top: 0;
        right: -50px;
        width: 150px;
        height: 150px;
        background: radial-gradient(circle, rgba(30, 167, 215, 0.1) 0%, rgba(30, 167, 215, 0) 70%);
        border-radius: 50%;
        z-index: -1;
    }
    
    .sidebar.active {
        left: 0;
    }
    
    /* Sidebar links container */
    .sidebar-links {
        display: flex;
        flex-direction: column;
        gap: 6px;
        padding: 0 20px;
    }
    
    /* Individual link styling */
    .sidebar-link {
        color: var(--text-light);
        text-decoration: none;
        padding: 18px 24px;
        font-size: 1.15rem;
        font-weight: 500;
        letter-spacing: 0.3px;
        border-radius: 10px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        margin: 0 8px;
        background: rgba(255, 255, 255, 0.03);
        border-left: 3px solid transparent;
    }
    
    /* Link hover and active states */
    .sidebar-link:hover {
        background: rgba(30, 167, 215, 0.15);
        color: var(--text-light);
        border-left: 3px solid var(--accent-color);
        transform: translateX(5px);
        box-shadow: var(--shadow-light);
    }
    
    .sidebar-link:active {
        transform: translateX(5px) scale(0.98);
    }
    
    /* Indicator for current page */
    .sidebar-link.active {
        background: rgba(30, 167, 215, 0.2);
        color: var(--text-light);
        border-left: 3px solid var(--accent-color);
        font-weight: 600;
    }
    
    /* Loading indicator for navigation */
    .sidebar-link.loading::after {
        content: '';
        position: absolute;
        right: 20px;
        width: 16px;
        height: 16px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top-color: var(--accent-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
    
    /* Sidebar header */
    .sidebar-header {
        padding: 0 28px 25px 28px;
        margin-bottom: 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .sidebar-title {
        color: var(--text-light);
        font-size: 1.4rem;
        font-weight: 700;
        letter-spacing: 1px;
        margin: 0;
        text-transform: uppercase;
    }
    
    .sidebar-subtitle {
        color: var(--text-medium);
        font-size: 0.9rem;
        margin-top: 5px;
        letter-spacing: 0.5px;
    }
    
    /* Sidebar footer */
    .sidebar-footer {
        margin-top: auto;
        padding: 25px 28px 0 28px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        color: var(--text-medium);
        font-size: 0.85rem;
        line-height: 1.5;
    }
    
    /* Overlay styling */
    .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 10, 20, 0.7);
        opacity: 0;
        pointer-events: none;
        transition: opacity var(--transition-speed) ease;
        z-index: 1000;
        backdrop-filter: blur(2px);
    }
    
    .overlay.active {
        opacity: 1;
        pointer-events: all;
    }
    
    /* Close button inside sidebar */
    .sidebar-close {
        position: absolute;
        top: 25px;
        right: 20px;
        background: none;
        border: none;
        color: var(--text-light);
        font-size: 1.8rem;
        cursor: pointer;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        z-index: 1003;
    }
    
    .sidebar-close:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: rotate(90deg);
    }
    
 

    
    .toggle-switch {
        position: relative;
        width: 50px;
        height: 24px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        cursor: pointer;
        transition: background 0.3s;
    }
    
    .toggle-switch.active {
        background: var(--accent-color);
    }
    
    .toggle-switch::after {
        content: '';
        position: absolute;
        top: 2px;
        left: 2px;
        width: 20px;
        height: 20px;
        background: white;
        border-radius: 50%;
        transition: transform 0.3s;
    }
    
    .toggle-switch.active::after {
        transform: translateX(26px);
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .sidebar {
            width: 260px;
            left: -260px;
        }
    }
    
    @media (max-width: 480px) {
        .sidebar {
            width: 100%;
            left: -100%;
            border-radius: 0;
        }
        
        .sidebar.active {
            left: 0;
        }
    }
</style>

<div id="sidebar" class="sidebar">
    <button class="sidebar-close" onclick="toggleMenu()">&times;</button>
    
    <div class="sidebar-header">
        <h2 class="sidebar-title">Navigation</h2>
        <p class="sidebar-subtitle">Explore</p>
    </div>
    
    <div class="sidebar-links">
        <!-- Home link with conditional navigation -->
        <a href="homepage.html" id="homeLink" class="sidebar-link">Profile</a>
        <a href="Photos.html" class="sidebar-link">Submit Photos</a>
        <a href="projects.html" class="sidebar-link">Subjects</a>
        <a href="services.html" class="sidebar-link">Services</a>
        <a href="contact.html" class="sidebar-link">Contact</a>
        <a href="blog.html" class="sidebar-link">Blog</a>
    </div>
    
    <div class="sidebar-footer">
        <p>Â© 2023 Your Company. All rights reserved.</p>
        
    </div>
</div>

<div id="overlay" class="overlay"></div>

<script>
const sidebar = document.getElementById("sidebar");
const overlay = document.getElementById("overlay");

let isNavigating = false;

// Toggle sidebar function
window.toggleMenu = function(){
    sidebar.classList.toggle("active");
    overlay.classList.toggle("active");
    document.body.style.overflow = sidebar.classList.contains("active") ? "hidden" : "auto";
};

// Close sidebar function
function closeSidebar() {
    sidebar.classList.remove("active");
    overlay.classList.remove("active");
    document.body.style.overflow = "auto";
}

// Overlay click to close
overlay.onclick = closeSidebar;

// Close sidebar with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && sidebar.classList.contains('active')) {
        closeSidebar();
    }
});

// Initialize page highlighting - THIS WILL WORK NOW because the page actually reloads
function highlightCurrentPage() {
    const currentPath = window.location.pathname;
    const currentPage = currentPath.split('/').pop() || 'homepage.html';
    const links = document.querySelectorAll('.sidebar-link');
    
    links.forEach(link => {
        const linkHref = link.getAttribute('href');
        const linkPage = linkHref ? linkHref.split('/').pop() : '';
        
        // Remove active class from all links
        link.classList.remove('active');
        
        // Normalize both names for comparison
        const currentPageNormalized = currentPage.replace('.html', '').toLowerCase();
        const linkPageNormalized = linkPage.replace('.html', '').toLowerCase();
        
        // Add active class to current page
        if (linkPageNormalized === currentPageNormalized) {
            link.classList.add('active');
        }
        
        // Special case for homepage
        if ((currentPageNormalized === '' || currentPageNormalized === 'index' || currentPageNormalized === 'homepage') && 
            (linkPageNormalized === 'homepage' || linkPageNormalized === 'index' || linkPageNormalized === '')) {
            link.classList.add('active');
        }
    });
}

// Run highlighting when page loads
document.addEventListener('DOMContentLoaded', highlightCurrentPage);
// Toggle sidebar function
window.toggleMenu = function(){
    sidebar.classList.toggle("active");
    overlay.classList.toggle("active");
    document.body.style.overflow = sidebar.classList.contains("active") ? "hidden" : "auto";
};

// Close sidebar function
function closeSidebar() {
    sidebar.classList.remove("active");
    overlay.classList.remove("active");
    document.body.style.overflow = "auto";
}

// Overlay click to close
overlay.onclick = closeSidebar;

// Handle link navigation WITHOUT preventing default
function handleNavigation(e, link) {
    const href = link.getAttribute('href');
    if (!href || href === '#' || href.startsWith('javascript:')) return;

    // Add loading indicator
    link.classList.add('loading');
    
    // Close sidebar on mobile
    if (window.innerWidth <= 768) {
        closeSidebar();
    }
    
    // Let the browser navigate naturally - DON'T call preventDefault()
    // The page will reload and highlightCurrentPage() will run on the new page
}

// Setup navigation handlers for all links
document.addEventListener('DOMContentLoaded', function() {
    const sidebarLinks = document.querySelectorAll('.sidebar-link');
    sidebarLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            handleNavigation(e, this);
            // Don't call e.preventDefault() - let the navigation happen
        });
    });
    
    // Highlight current page on load
    highlightCurrentPage();
});

// Close sidebar with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && sidebar.classList.contains('active')) {
        closeSidebar();
    }
});

// Update active link when browser back/forward buttons are used
window.addEventListener('popstate', highlightCurrentPage);

// Optional: Function to manually close sidebar
window.closeSidebar = closeSidebar;

// Optional: Function to open sidebar
window.openSidebar = function() {
    sidebar.classList.add("active");
    overlay.classList.add("active");
    document.body.style.overflow = "hidden";
};
</script>